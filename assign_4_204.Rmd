---
title: "Homework #4 (A Climate Change Model)"
author: "Gavi, Lizzie, Simone"
date: "5/19/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(tidyr)
library(tidyverse)
library(janitor)
library(ggplot2)
library(wesanderson)
library(dplyr)
library(scales)
library(purrr)
```


Business as Usual Functions and Parameters 
```{r}
# No Climate Change 
# define function Temperature over time 

zero_cc_run <- function(t, T){

#define variables
T<- 0 #BAU temperature increase at year 100
yr_span<- 100 #span of time 
s<- .005 # pure rate of time preference
n<- .5 #how does income change value of money
g<- .01 #rate economic growth
B<- .05 
  
#find the temperature
temperature<-  min(t*T/yr_span, T)

# fraction of economic activity that is retained in a year 
yr_econ_activity<- exp(-B*(temperature)^2)

#Total economic activity/consumption 
total_econ_activity<- (yr_econ_activity)*exp(g*t)


return(data.frame(time=t, 
                  marginal_T_change=T, 
                    temperature= temperature, 
                    yr_econ_activity=yr_econ_activity, 
                    total_econ_activity=total_econ_activity))
}

zero_cc_df <- purrr::map2_dfr(seq(from=0,to=200,by=1), T, zero_cc_run)


```

```{r}
# Moderate Climate Change 
# define function Temperature over time 

mod_cc_run <- function(t, T){

#define variables
T<- 2 #BAU temperature increase at year 100
yr_span<- 100 #span of time 
s<- .005 # pure rate of time preference
n<- .5 #how does income change value of money
g<- .01 #rate economic growth
B<- .05 
  
#find the temperature
temperature<-  min(t*T/yr_span, T)

# fraction of economic activity that is retained in a year 
yr_econ_activity<- exp(-B*(temperature)^2)

#Total economic activity/consumption 
total_econ_activity<- (yr_econ_activity)*exp(g*t)


return(data.frame(time=t, 
                  marginal_T_change=T, 
                    temperature= temperature, 
                    yr_econ_activity=yr_econ_activity, 
                    total_econ_activity=total_econ_activity))
}

mod_cc_df <- purrr::map2_dfr(seq(from=0,to=200,by=1), T, mod_cc_run)


```

```{r}
# No Climate Change 
# define function Temperature over time 

ext_cc_run <- function(t, T){

#define variables
T<- 8 #BAU temperature increase at year 100
yr_span<- 100 #span of time 
s<- .005 # pure rate of time preference
n<- .5 #how does income change value of money
g<- .01 #rate economic growth
B<- .05 
  
#find the temperature
temperature<-  min(t*T/yr_span, T)

# fraction of economic activity that is retained in a year 
yr_econ_activity<- exp(-B*(temperature)^2)

#Total economic activity/consumption 
total_econ_activity<- (yr_econ_activity)*exp(g*t)


return(data.frame(time=t, 
                  marginal_T_change=T, 
                    temperature= temperature, 
                    yr_econ_activity=yr_econ_activity, 
                    total_econ_activity=total_econ_activity))
}

ext_cc_df <- purrr::map2_dfr(seq(from=0,to=200,by=1), T, ext_cc_run)


```
1. Plots

A. Temperature over time 
```{r plot_no_cc_over_time}
ggplot()+
  geom_point(data = zero_cc_df, aes(x= time, y = temperature),color="red")+
  geom_point(data = mod_cc_df, aes(x= time, y = temperature),color="blue")+
  geom_point(data = ext_cc_df, aes(x= time, y = temperature),color="green")+
  xlim(0,200)
```

```{r}
#no climate change (T = 0)

#modest climate change (T = 2)
#with extreme climate change (T = 8)
```

B. Consumption over time 
```{r}
#no climate change 
#modest climate change 
#with extreme climate change 
```

c.  Undiscounted utility over time 
```{r}
#no climate change
#modest climate change 
#with extreme climate change 
```

```{r}

```



2. Analysis

A. 

Present value (i.e. discounted) utility over the next 200 years with climate change
```{r}
#Suppose T = 4.4. (under BAU, climate change will eventually lead to a 4.4 degree increase in temperature)

```


Present value utility without climate change
```{r}

```

Percentage loss in present value utility from climate change (call this L)
```{r}

```

B. Sensitivity Analysis of L 

Percent change in L that arises from a 10% increase in each of parameters (B, n, g, T)
```{r}
# create function to run model with many different inputs 

```

C. Prevent climate change from occurring requires giving up a fraction theta of consumption every year for the next 200 years. Maximum value of theta society would be willing to endure every year to completely prevent climate change, theta*

```{r}
# assume original parameters
#T = 0 instead of T = 4.4

```

D. Suppose we are uncertain about T

Theta* under uncertainty over T
```{r}
#probability distribution:T = 2 (with probability .2), T = 4 (with probability .5), and T = 6 (with probability .3)

```

